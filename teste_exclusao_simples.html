<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Exclus√£o Simples</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <h1>üß™ Teste de Exclus√£o de Tarefas</h1>

        <div class="alert alert-info">
            <strong>Status:</strong> <span id="status">Carregando...</span>
        </div>

        <div class="card">
            <div class="card-header">
                <h5>Tarefas de Teste</h5>
            </div>
            <div class="card-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Nome</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Tarefa de Teste 1</td>
                            <td>
                                <button class="btn btn-danger btn-sm btn-excluir-tarefa" data-tarefa-id="teste-1">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Tarefa de Teste 2</td>
                            <td>
                                <button class="btn btn-danger btn-sm btn-excluir-tarefa" data-tarefa-id="teste-2">
                                    <i class="fas fa-trash"></i> Excluir
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="mt-3">
            <button class="btn btn-primary" onclick="verificarStatus()">Verificar Status</button>
            <button class="btn btn-warning" onclick="forcarReconfiguracao()">For√ßar Reconfigura√ß√£o</button>
        </div>

        <div class="mt-3">
            <h6>Console Log:</h6>
            <div id="console-log"
                style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace; max-height: 300px; overflow-y: auto;">
            </div>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Script de corre√ß√£o -->
    <script src="static/js/correcao_exclusao_tarefas.js"></script>

    <script>
        // Interceptar console.log para mostrar na tela
        const originalLog = console.log;
        const originalError = console.error;
        const consoleDiv = document.getElementById('console-log');

        function addToConsole(message, type = 'log') {
            const div = document.createElement('div');
            div.style.color = type === 'error' ? 'red' : 'black';
            div.style.marginBottom = '5px';
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            consoleDiv.appendChild(div);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        console.log = function (...args) {
            originalLog.apply(console, args);
            addToConsole(args.join(' '));
        };

        console.error = function (...args) {
            originalError.apply(console, args);
            addToConsole(args.join(' '), 'error');
        };

        // Fun√ß√µes de teste
        function verificarStatus() {
            if (typeof window.verificarStatusExclusao === 'function') {
                window.verificarStatusExclusao();
            } else {
                console.error('Fun√ß√£o verificarStatusExclusao n√£o est√° dispon√≠vel');
            }
        }

        function forcarReconfiguracao() {
            if (typeof window.forcarReconfiguracao === 'function') {
                window.forcarReconfiguracao();
            } else {
                console.error('Fun√ß√£o forcarReconfiguracao n√£o est√° dispon√≠vel');
            }
        }

        // Verificar status inicial
        setTimeout(() => {
            const statusSpan = document.getElementById('status');
            if (typeof window.corrigirExclusaoTarefas === 'function') {
                statusSpan.textContent = '‚úÖ Sistema carregado com sucesso!';
                statusSpan.className = 'text-success';
            } else {
                statusSpan.textContent = '‚ùå Sistema n√£o carregou corretamente';
                statusSpan.className = 'text-danger';
            }
        }, 2000);
    </script>
</body>

</html>